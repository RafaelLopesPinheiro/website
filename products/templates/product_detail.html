{% extends 'home.html'%}

{% block head %}
{% include 'navbar.html'%}
{% load static %}

  <script>
    var tokenElement = '{% csrf_token %}';
    let doc = new DOMParser().parseFromString(tokenElement, "text/html");
    let token = Array.from(doc.getElementsByTagName("input"));
    localStorage.setItem("CSRFToken", token.value);
  </script>


  <script src="{% static '/js/sendorder.js' %}" type="module" defer> </script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <link href="{% static '/js/style.css'%}" type="text/css">

  <style>
    .box-shadow {
      box-shadow: 0 16px 24px 2px rgba(0, 0, 0, .14), 0 6px 30px 5px rgba(0, 0, 0, .12), 0 8px 10px -5px rgba(0, 0, 0, .2)
  }
  </style>


  <script type="text/javascript"> 
    
      function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    function uuidv4() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    let device = getCookie('device')

    if (device == null || device == undefined){
      device = uuidv4()
    }

    document.cookie = 'device=' + device + ";domain=;path=/" 


  </script>




{% endblock head%}


{% block content %}
{% comment %} <form method='POST'> {%csrf_token%} {% endcomment %}
  {% comment %} <h3 class='text-center'>{{item}}</h3> {% endcomment %}
  <h4 class='px-3'>Escolha seus acompanhamentos: </h4>
  <div id="acomp_form" class='card'>
    <div id="acomp_list" class='list-group list-group-flush '>
      {% for item in object %}
        <div id='acomp_list_item_{{forloop.counter0}}' class='d-flex justify-content-end border-bottom mb-2 mt-2 px-8' style='text-align:center'>
          <h4><p id='acomp_name_{{forloop.counter0}}' class='align-self-center'>{{item}}</p></h4>
          
          <button class="btn btn-danger box-shadow decrement mb-2 ml-2"  style='border-radius:50%;' disabled> - </button>
          <p class='inline-block qty-input float-center align-self-center' style='text-align:right' id='acomp_qty_{{forloop.counter0}}' >0</p>
          <button class="btn btn-success box-shadow increment mb-2 " style='border-radius:50%; ' > + </button>
          <hr class='mb-2 mt-2'></hr>
        </div>
      
      {% endfor %}
    </div>
    <input type='text' placeholder ='observações'></input>
    <h5 style="text-align: right">Valor: R${{ item.price|floatformat:2 }}</h5>

    <button id="sendOrderButton" type="button" class='bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded'>Confirmar</button>
  </div>
  {% comment %} ADD ON BUTTON ABOVE TO SAVE ITEMS ON BACKEND {% endcomment %}
{% comment %} onclick="location.href={% url 'cart:cart'%}" {% endcomment %}


  <script src="{% static '/js/incrementButtons.js' %}"> </script>
{% endblock %}

